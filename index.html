<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Devilswahn's Bootlegs</title>

<link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;600&family=Roboto:wght@300;400&display=swap" rel="stylesheet">

<style>
:root {
  --red: #b00000;
  --darkred: #600;
  --bg: #000;
  --panel: #0b0b0b;
  --border: #400;
}

body {
  margin: 0;
  font-family: Roboto, Arial, sans-serif;
  background: radial-gradient(circle at top, #300 0%, #000 65%);
  color: #ddd;
}

.container {
  max-width: 960px;
  margin: 40px auto;
  background: var(--panel);
  border: 1px solid var(--border);
  box-shadow: 0 0 40px rgba(255,0,0,.35);
}

header {
  padding: 25px 20px;
  text-align: center;
  border-bottom: 2px solid var(--darkred);
}

header h1 {
  margin: 0;
  font-family: Oswald, sans-serif;
  letter-spacing: 4px;
  color: #f33;
}

/* TABS */
.tabs {
  display: flex;
  gap: 6px;
  padding: 12px 15px;
  background: linear-gradient(#120000, #000);
  border-bottom: 1px solid var(--border);
}

.tabs button {
  background: #160000;
  color: #bbb;
  border: 1px solid var(--border);
  padding: 8px 16px;
  font-family: Oswald, sans-serif;
  letter-spacing: 1px;
  text-transform: uppercase;
  cursor: pointer;
}

.tabs button:hover {
  background: #300;
  color: #fff;
}

.tabs button.active {
  background: var(--red);
  color: #fff;
  border-color: #f00;
  box-shadow: 0 0 12px rgba(255,0,0,.6);
}

/* TITLE */
h3 {
  margin: 25px 20px 10px;
  font-family: Oswald, sans-serif;
  font-size: 26px;
  letter-spacing: 2px;
  color: #f33;
  border-left: 4px solid var(--red);
  padding-left: 12px;
}

/* SEARCH */
.search {
  margin: 10px 20px;
}

.search input {
  width: 100%;
  padding: 8px 10px;
  background: #000;
  color: #fff;
  border: 1px solid var(--border);
  font-size: 14px;
}

/* INDEX */
.index {
  margin: 15px 20px;
  text-align: center;
}

.index span {
  display: inline-block;
  margin: 4px 6px;
  padding: 4px 7px;
  font-family: Oswald, sans-serif;
  font-size: 13px;
  background: #100;
  border: 1px solid var(--border);
  cursor: pointer;
}

.index span:hover {
  background: var(--red);
  border-color: #f00;
  color: #fff;
}

/* CONTENT */
#content {
  padding: 0 20px 30px;
}

.artist {
  margin-top: 30px;
  font-family: Oswald, sans-serif;
  font-size: 18px;
  letter-spacing: 1px;
  color: #fff;
  border-bottom: 1px solid var(--border);
  padding-bottom: 4px;
}

.bootleg {
  display: block;
  margin: 6px 0 0 18px;
  font-size: 14px;
  color: #ccc;
}

.bootleg::before {
  content: "▸ ";
  color: #f33;
}

footer {
  height: 22px;
  background: linear-gradient(to right, #000, #400, #000);
}
</style>
</head>

<body>

<div class="container">

<header>
  <h1>DEVILSWAHN'S BOOTLEGS</h1>
</header>

<div class="tabs">
  <button onclick="showTab('new', this)">New Shit</button>
  <button onclick="showTab('audio', this)">Audio</button>
  <button class="active" onclick="showTab('video', this)">Video</button>
  <button onclick="showTab('links', this)">Links</button>
  <button onclick="showTab('contact', this)">Contact</button>
</div>

<h3 id="tab-title">Video</h3>
<div class="search">
  <input id="search" placeholder="Filter artist or title…">
</div>
<div class="index" id="az-index"></div>
<div id="content"></div>

<footer></footer>

</div>

<script>
const sources = {
  audio: "https://docs.google.com/spreadsheets/d/1rxEFXEDSxOCUVUpEq1mqhlknVP19X-Wwt5K-jOOjkqU/export?format=csv&gid=0",
  video: "https://docs.google.com/spreadsheets/d/1rxEFXEDSxOCUVUpEq1mqhlknVP19X-Wwt5K-jOOjkqU/export?format=csv&gid=1495617644"
};

let fullData = {};

function showTab(tab, btn) {
  document.querySelectorAll(".tabs button").forEach(b => b.classList.remove("active"));
  btn.classList.add("active");

  document.getElementById("tab-title").textContent =
    tab === "new" ? "New Shit" :
    tab.charAt(0).toUpperCase() + tab.slice(1);

  document.getElementById("content").innerHTML = "";
  document.getElementById("az-index").innerHTML = "";
  document.getElementById("search").value = "";

  if (sources[tab]) loadCsv(sources[tab]);
  else document.getElementById("content").innerHTML = "<p>Content coming soon.</p>";
}

function loadCsv(url) {
  fetch(url)
    .then(r => r.text())
    .then(csv => {
      const rows = csv.split(/\r?\n/).slice(1);
      fullData = {};

      rows.forEach(r => {
        const cols = r.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/)
                      .map(c => c.replace(/"/g,"").trim());
        if (!cols[0]) return;

        const artist = cols[0];
        const title = cols.find((c,i)=>i>0 && c);
        if (!title) return;

        (fullData[artist] ??= []).push(title);
      });

      render(fullData);
    });
}

function render(data) {
  const content = document.getElementById("content");
  const index = document.getElementById("az-index");
  content.innerHTML = "";
  index.innerHTML = "";

  let current = "";

  Object.keys(data).sort((a,b)=>a.localeCompare(b,"en",{sensitivity:"base"}))
    .forEach(artist => {
      const letter = artist[0].toUpperCase();
      if (letter !== current) {
        current = letter;
        const s = document.createElement("span");
        s.textContent = letter;
        s.onclick = ()=>document.getElementById("a-"+letter).scrollIntoView();
        index.appendChild(s);

        const a = document.createElement("div");
        a.id = "a-"+letter;
        content.appendChild(a);
      }

      const ad = document.createElement("div");
      ad.className = "artist";
      ad.textContent = artist;
      content.appendChild(ad);

      data[artist].forEach(t => {
        const sp = document.createElement("span");
        sp.className = "bootleg";
        sp.textContent = t;
        content.appendChild(sp);
      });
    });
}

document.getElementById("search").addEventListener("input", e => {
  const q = e.target.value.toLowerCase();
  const filtered = {};
  for (const a in fullData) {
    const hits = fullData[a].filter(v =>
      a.toLowerCase().includes(q) || v.toLowerCase().includes(q)
    );
    if (hits.length) filtered[a] = hits;
  }
  render(filtered);
});

/* Load Video by default */
loadCsv(sources.video);
</script>

</body>
</html>
